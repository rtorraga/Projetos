!function(a){var b={image:null,frame_count:0,loop:!1,autoplay:!1,delay:0,inverted:!1,velocity:500,onComplete:null,onFrame:null},c=[],d={init:function(c){var d=a.extend({},b,c);return this.each(function(){a.fn.imageSpritePlay.process(a(this),d)})},first:function(){return this.each(function(){a.fn.imageSpritePlay.first(this)})},previous:function(){return this.each(function(){a.fn.imageSpritePlay.previous(this)})},play:function(){return this.each(function(){a.fn.imageSpritePlay.play(this)})},delay_play:function(b){return this.each(function(){a.fn.imageSpritePlay.delay_play(this,b)})},pause:function(){return this.each(function(){a.fn.imageSpritePlay.pause(this)})},resume:function(){return this.each(function(){a.fn.imageSpritePlay.resume(this)})},stop:function(){return this.each(function(){a.fn.imageSpritePlay.stop(this)})},next:function(){return this.each(function(){a.fn.imageSpritePlay.next(this)})},"goto":function(b){return this.each(function(){a.fn.imageSpritePlay.goto(this,b)})},restart:function(){return this.each(function(){a.fn.imageSpritePlay.restart(this)})},refresh:function(){return this.each(function(){a.fn.imageSpritePlay.refresh(this)})},last:function(){return this.each(function(){a.fn.imageSpritePlay.last(this)})},velocity:function(b){return this.each(function(){a.fn.imageSpritePlay.velocity(this,b)})},loop:function(b){return this.each(function(){a.fn.imageSpritePlay.loop(this,b)})},invert:function(){return this.each(function(){a.fn.imageSpritePlay.invert(this)})},delay:function(b){return this.each(function(){a.fn.imageSpritePlay.delay(this,b)})},attach:function(b,c){return this.each(function(){a.fn.imageSpritePlay.attach(this,b,c)})}};a.fn.imageSpritePlay=function(b){return d[b]?d[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist on jQuery.imageSpritePlay"),void 0):d.init.apply(this,arguments)},a.fn.imageSpritePlay.makeId=function(){for(var a="",b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz0123456789",c=b.length,d=0;8>d;d++)a+=b.charAt(Math.floor(Math.random()*c));return a},a.fn.imageSpritePlay.loop=function(b,d){var e="object"==typeof b?a(b).attr("data-sprite-ids"):b;c[e].options.loop=d,a.fn.imageSpritePlay.refresh(e)},a.fn.imageSpritePlay.delay=function(b,d){var e="object"==typeof b?a(b).attr("data-sprite-ids"):b;c[e].options.delay=d,a.fn.imageSpritePlay.refresh(e)},a.fn.imageSpritePlay.invert=function(b){var d="object"==typeof b?a(b).attr("data-sprite-ids"):b;c[d].options.inverted=!c[d].options.inverted,null!==c[d].timer&&a.fn.imageSpritePlay.refresh(d)},a.fn.imageSpritePlay.velocity=function(b,d){var e="object"==typeof b?a(b).attr("data-sprite-ids"):b;c[e].options.velocity=d,null!==c[e].timer&&a.fn.imageSpritePlay.refresh(e)},a.fn.imageSpritePlay.delay_play=function(b,d){var e="object"==typeof b?a(b).attr("data-sprite-ids"):b;setTimeout(function(){c[e].options.delay=0,a.fn.imageSpritePlay.play(e)},d)},a.fn.imageSpritePlay.play=function(b){var d="object"==typeof b?a(b).attr("data-sprite-ids"):b;if(void 0!==d){if(c[d].options.delay>0)return a.fn.imageSpritePlay.delay_play(d,c[d].options.delay);null!==c[d].timer&&clearInterval(c[d].timer),a.fn.imageSpritePlay.first(d),c[d].timer=setInterval(function(){a.fn.imageSpritePlay.next(d)},c[d].options.velocity)}},a.fn.imageSpritePlay.pause=function(b){var d="object"==typeof b?a(b).attr("data-sprite-ids"):b;void 0!==d&&null!==c[d].timer&&clearInterval(c[d].timer)},a.fn.imageSpritePlay.stop=function(b){var d="object"==typeof b?a(b).attr("data-sprite-ids"):b;void 0!==d&&null!==c[d].timer&&clearInterval(c[d].timer)},a.fn.imageSpritePlay.resume=function(b){var d="object"==typeof b?a(b).attr("data-sprite-ids"):b;void 0!==d&&(null!==c[d].timer&&clearInterval(c[d].timer),c[d].timer=setInterval(function(){a.fn.imageSpritePlay.next(d)},c[d].options.velocity))},a.fn.imageSpritePlay.refresh=function(b){a.fn.imageSpritePlay.pause(b),a.fn.imageSpritePlay.resume(b)},a.fn.imageSpritePlay.restart=function(b){a.fn.imageSpritePlay.stop(b),a.fn.imageSpritePlay.play(b)},a.fn.imageSpritePlay.goto=function(b,d){var e="object"==typeof b?a(b).attr("data-sprite-ids"):b;void 0!==e&&(c[e].frame=d-1,a.fn.imageSpritePlay.updateFrame(e))},a.fn.imageSpritePlay.first=function(b){var d="object"==typeof b?a(b).attr("data-sprite-ids"):b;void 0!==d&&(c[d].frame=c[d].options.inverted?c[d].options.frame_count-1:0,a.fn.imageSpritePlay.updateFrame(d))},a.fn.imageSpritePlay.previous=function(b,d){var e="object"==typeof b?a(b).attr("data-sprite-ids"):b;if(void 0!==e){if(void 0===d&&c[e].options.inverted)return a.fn.imageSpritePlay.next(e,!0);if(c[e].options.loop===!1){if(!(c[e].frame>0))return null!==c[e].timer&&(a.fn.imageSpritePlay._onComplete(e),clearInterval(c[e].timer)),void 0;c[e].frame--}else c[e].frame>0?c[e].frame--:(a.fn.imageSpritePlay._onComplete(e),c[e].frame=c[e].options.frame_count-1);a.fn.imageSpritePlay.updateFrame(e)}},a.fn.imageSpritePlay.next=function(b,d){var e="object"==typeof b?a(b).attr("data-sprite-ids"):b;if(void 0!==e){if(void 0===d&&c[e].options.inverted)return a.fn.imageSpritePlay.previous(e,!0);if(c[e].options.loop===!1){if(c[e].frame>=c[e].options.frame_count-1)return null!==c[e].timer&&(a.fn.imageSpritePlay._onComplete(e),clearInterval(c[e].timer)),void 0;c[e].frame++}else c[e].frame<c[e].options.frame_count-1?c[e].frame++:(a.fn.imageSpritePlay._onComplete(e),c[e].frame=0);a.fn.imageSpritePlay.updateFrame(e)}},a.fn.imageSpritePlay._onComplete=function(b){var d="object"==typeof b?a(b).attr("data-sprite-ids"):b;null!==c[d].options.onComplete&&c[d].options.onComplete.call(this,c[d])},a.fn.imageSpritePlay._onFrame=function(b){var d="object"==typeof b?a(b).attr("data-sprite-ids"):b;null!==c[d].options.onFrame&&c[d].options.onFrame.call(this,c[d])},a.fn.imageSpritePlay.last=function(b){var d="object"==typeof b?a(b).attr("data-sprite-ids"):b;void 0!==d&&(c[d].frame=c[d].options.inverted?0:c[d].options.frame_count-1,a.fn.imageSpritePlay.updateFrame(d))},a.fn.imageSpritePlay.updateFrame=function(b){var d=-1*c[b].frame*c[b].image.frame_size;switch(c[b].direction){case"h":c[b].element.css("background-position",d+"px 0px");break;case"v":c[b].element.css("background-position","0px "+d+"px")}a.fn.imageSpritePlay._onFrame(b)},a.fn.imageSpritePlay.attach=function(b,d,e){var f="object"==typeof b?a(b).attr("data-sprite-ids"):b;void 0!==f&&(c[f].attached={marginTop:d,marginBottom:e},a.fn.imageSpritePlay._ajustRuler(c[f]),a(window).scroll(function(){a.fn.imageSpritePlay._ajustRuler(c[f])}),a(window).resize(function(){a.fn.imageSpritePlay._ajustRuler(c[f])}))},a.fn.imageSpritePlay._ajustRuler=function(b){var c=b.attached.marginTop,d=b.attached.marginBottom,e=a(window).scrollTop(),f=e+a(window).height()/2,g=f-c,h=f+d,i=b.element.offset().top;if(i>g&&h>i){var j=c+d,k=i-g,l=100*k/j,m=Math.round(l*b.options.frame_count/100);0>=m&&(m=1),b.element.imageSpritePlay("goto",m),a("#regua").css("backgroundColor","red")}else a("#regua").css("backgroundColor","blue")},a.fn.imageSpritePlay.process=function(b,d){for(var e=a.fn.imageSpritePlay.makeId();void 0!==c[e];)e=a.fn.imageSpritePlay.makeId();var f={};f.element=b,f.options=d,f.frame=0,f.direction="",f.image={},f.image.frame_size=0,f.image.loaded=!1,f.timer=null,f.attached=null,c[e]=f,b.attr("data-sprite-ids",e).addClass("ImageSpritePlay");var g=new Image;g.src=d.image,g.onload=function(){switch(c[e].image.loaded=!0,c[e].image.image=g,c[e].image.width=g.width,c[e].image.height=g.height,c[e].direction=c[e].image.width>c[e].image.height?"h":"v",c[e].direction){case"h":c[e].image.frame_size=c[e].image.width/c[e].options.frame_count,c[e].element.css("width",c[e].image.frame_size).css("height",c[e].image.height).css("background-image","url("+c[e].options.image+")").css("background-repeat","no-repeat").css("background-position","0px 0px");break;case"v":c[e].image.frame_size=c[e].image.height/c[e].options.frame_count,c[e].element.css("width",c[e].image.width).css("height",c[e].image.frame_size).css("background-image","url("+c[e].options.image+")").css("background-repeat","no-repeat").css("background-position","0px 0px")}c[e].options.autoplay&&a.fn.imageSpritePlay.play(e)}}}(jQuery);
